<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Editor de Tarefa - LevelUp</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- CSS -->
    <link rel="stylesheet" th:href="@{/css/admin-layout.css}">
    <link rel="stylesheet" th:href="@{/css/task-form.css}">
</head>
<body>

<div class="wrapper">
    <!-- Sidebar -->
    <nav th:replace="~{fragments/sidebar :: sidebar}"></nav>

    <!-- CONTEÃšDO CENTRALIZADO -->
    <!-- Adicionado 'min-vh-100', 'flex-column', 'justify-content-center', 'align-items-center' -->
    <div id="content" class="d-flex flex-column justify-content-center align-items-center min-vh-100">

        <div class="container animate__animated animate__fadeInUp" style="max-width: 850px;">

            <!-- Painel da IA -->
            <div class="ai-panel" th:if="${!isEdit}">
                <div class="ai-panel-content text-center"> <!-- Texto centralizado no painel IA -->
                    <div class="ai-title justify-content-center">
                        <i class="fa-solid fa-wand-magic-sparkles me-2 fa-lg"></i>
                        IA Brainstorm
                    </div>
                    <p class="ai-description">
                        Sem ideias criativas? Digite um tema (ex: "Semana da SaÃºde", "Code Review em Pares") e deixe nossa IA gerar a tarefa para vocÃª.
                    </p>
                    <div class="input-group" style="max-width: 500px; margin: 0 auto;">
                        <input type="text" id="aiTopic" class="form-control form-control-tech" placeholder="Digite um tema aqui..." style="border-top-right-radius: 0; border-bottom-right-radius: 0;">
                        <button class="btn btn-ai px-4" type="button" id="btnGenerateAi">
                            <i class="fa-solid fa-bolt me-2"></i> Gerar
                        </button>
                    </div>
                    <div id="aiLoading" class="mt-3 d-none text-warning fw-bold">
                        <i class="fa-solid fa-circle-notch fa-spin me-2"></i> Consultando o orÃ¡culo da IA...
                    </div>
                </div>
            </div>

            <!-- Card do FormulÃ¡rio Principal -->
            <div class="form-card">
                <div class="form-card-header text-center"> <!-- TÃ­tulo centralizado -->
                    <h4 th:text="${isEdit ? 'Editar Tarefa' : 'Nova Tarefa'}">Tarefa</h4>
                </div>
                <div class="form-card-body">
                    <form th:action="@{${isEdit ? '/admin/tasks/update' : '/admin/tasks/save'}}"
                          th:object="${taskDto}" method="post">

                        <input type="hidden" th:field="*{id}" th:if="${isEdit}">
                        <input type="hidden" th:field="*{isActive}" th:if="${isEdit}">

                        <div class="mb-4">
                            <!-- Labels explicitamente acima -->
                            <label for="title" class="form-label d-block">TÃ­tulo da Tarefa</label>
                            <input type="text" class="form-control-tech w-100" id="title" th:field="*{title}" placeholder="Ex: Organizar Hackathon" required>
                            <small class="text-danger" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></small>
                        </div>

                        <div class="row mb-4">
                            <div class="col-md-6">
                                <label for="taskType" class="form-label d-block">Categoria</label>
                                <select class="form-select form-control-tech w-100" id="taskType" th:field="*{taskType}">
                                    <option value="WORK">ðŸ’¼ Trabalho (TÃ©cnico)</option>
                                    <option value="SOCIAL">ðŸŽ‰ Social (IntegraÃ§Ã£o)</option>
                                    <option value="WELLNESS">ðŸ§˜ Bem-Estar (SaÃºde)</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="pointsValue" class="form-label d-block">Pontos (XP)</label>
                                <div class="input-group">
                                    <span class="input-group-text bg-dark border-secondary text-warning fw-bold">XP</span>
                                    <input type="number" class="form-control form-control-tech" id="pointsValue" th:field="*{pointsValue}" min="1" placeholder="Ex: 50">
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="description" class="form-label d-block">DescriÃ§Ã£o Detalhada</label>
                            <textarea class="form-control-tech w-100" id="description" th:field="*{description}" rows="5" placeholder="Descreva o que deve ser feito, critÃ©rios de aceite, etc..."></textarea>
                        </div>

                        <div class="d-flex justify-content-center gap-3 mt-5"> <!-- BotÃµes centralizados -->
                            <a href="/admin/tasks" class="btn btn-tech-outline">
                                Cancelar
                            </a>
                            <button type="submit" class="btn btn-tech-primary px-5">
                                <i class="fa-solid fa-floppy-disk me-2"></i>
                                Salvar Tarefa
                            </button>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/task-form.js}"></script>

</body>
</html>